
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
      <link rel="icon" href="../../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.2.3, mkdocs-material-7.1.2">
    
    
      
        <title>Using the Vagrant Runner - build-magic</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/main.6f955dcd.min.css">
      
        
        <link rel="stylesheet" href="../../../assets/stylesheets/palette.ef6f36e2.min.css">
        
          
          
          <meta name="theme-color" content="#009485">
        
      
    
    
    
      
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback">
        <style>:root{--md-text-font-family:"Roboto";--md-code-font-family:"Roboto Mono"}</style>
      
    
    
    
    
      
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="" data-md-color-primary="teal" data-md-color-accent="light-blue">
  
    
    <script>function __prefix(e){return new URL("../../..",location).pathname+"."+e}function __get(e,t=localStorage){return JSON.parse(t.getItem(__prefix(e)))}</script>
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#using-the-vagrant-command-runner" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../.." title="build-magic" class="md-header__button md-logo" aria-label="build-magic" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            build-magic
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Using the Vagrant Runner
            
          </span>
        </div>
      </div>
    </div>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
      </label>
      
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" data-md-state="active" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </label>
      <button type="reset" class="md-search__icon md-icon" aria-label="Clear" tabindex="-1">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../.." title="build-magic" class="md-nav__button md-logo" aria-label="build-magic" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    build-magic
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../.." class="md-nav__link">
        Home
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../../CHANGELOG/" class="md-nav__link">
        What's New
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../../getting_started/" class="md-nav__link">
        Getting Started
      </a>
    </li>
  

    
      
      
      

  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4" type="checkbox" id="__nav_4" checked>
      
      <label class="md-nav__link" for="__nav_4">
        User Guide
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="User Guide" data-md-level="1">
        <label class="md-nav__title" for="__nav_4">
          <span class="md-nav__icon md-icon"></span>
          User Guide
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../core_concepts/" class="md-nav__link">
        Core Concepts
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../basic_usage/" class="md-nav__link">
        Using Build-magic
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../cli_usage/" class="md-nav__link">
        Using the CLI
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../config_usage/" class="md-nav__link">
        Defining Config Files
      </a>
    </li>
  

          
            
  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_5" type="checkbox" id="__nav_4_5" checked>
      
      <label class="md-nav__link" for="__nav_4_5">
        Using Command Runners
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Using Command Runners" data-md-level="2">
        <label class="md-nav__title" for="__nav_4_5">
          <span class="md-nav__icon md-icon"></span>
          Using Command Runners
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../local_usage/" class="md-nav__link">
        Using the Local Runner
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../docker_usage/" class="md-nav__link">
        Using the Docker Runner
      </a>
    </li>
  

          
            
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          Using the Vagrant Runner
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        Using the Vagrant Runner
      </a>
      
        
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#using-a-virtual-machine-compared-to-a-container" class="md-nav__link">
    Using a Virtual Machine Compared to a Container
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#running-shell-commands" class="md-nav__link">
    Running Shell Commands
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#setting-the-working-directory" class="md-nav__link">
    Setting the Working Directory
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#copying-files-into-the-virtual-machine" class="md-nav__link">
    Copying Files Into the Virtual Machine
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#debugging-the-virtual-machine" class="md-nav__link">
    Debugging the Virtual Machine
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../remote_usage/" class="md-nav__link">
        Using the Remote Runner
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../../examples/" class="md-nav__link">
        Examples
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../../troubleshooting/" class="md-nav__link">
        Troubleshooting
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../../comparison/" class="md-nav__link">
        Comparison with Similar Tools
      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#using-a-virtual-machine-compared-to-a-container" class="md-nav__link">
    Using a Virtual Machine Compared to a Container
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#running-shell-commands" class="md-nav__link">
    Running Shell Commands
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#setting-the-working-directory" class="md-nav__link">
    Setting the Working Directory
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#copying-files-into-the-virtual-machine" class="md-nav__link">
    Copying Files Into the Virtual Machine
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#debugging-the-virtual-machine" class="md-nav__link">
    Debugging the Virtual Machine
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content" data-md-component="content">
            <article class="md-content__inner md-typeset">
              
                
                
                <h1 id="using-the-vagrant-command-runner">Using the Vagrant Command Runner<a class="headerlink" href="#using-the-vagrant-command-runner" title="Permanent link">&para;</a></h1>
<p>The <em>vagrant</em> Command Runner executes commands in a virtual machine. Vagrant is a command line utility for creating and managing virtual machines. A specialized Ruby script called a Vagrantfile is used to provision the virtual machine.</p>
<p>Build-magic will start a new virtual machine provisioned by a specified Vagrantfile. The path to the Vagrantfile can be provided by the <strong>--environment</strong> option. When the Stage ends, build-magic will destroy the virtual machine so that it doesn't continue to use resources on the host machine.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Virtual machines are significantly slower to start up compared to containers. Depending on the Vagrant Box used, the VM Provider configured, and the host machine resources, the virtual machine can take 30+ seconds to start up.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Build-magic only supports Linux-based Vagrant Boxes with the <em>vagrant</em> Command Runner.</p>
</div>
<h2 id="using-a-virtual-machine-compared-to-a-container">Using a Virtual Machine Compared to a Container<a class="headerlink" href="#using-a-virtual-machine-compared-to-a-container" title="Permanent link">&para;</a></h2>
<p>There are a few noteworthy differences between using the <em>vagrant</em> Command Runner to execute commands in a virtual machine vs using the <em>docker</em> Command Runner to execute commands in a container.</p>
<ul>
<li>Virtual machines much more closely resemble a full operating system compared to a container. This can be useful when testing package installation for a target operating system/distribution/version. Containers are relatively minimal and won't have a lot of programs or libraries available by default.</li>
<li>Virtual machines are significantly slower to start up compared to a container.</li>
<li>Virtual machines typically consume more resources (CPU, memory, disk space) on the host machine compared to containers.</li>
</ul>
<h2 id="running-shell-commands">Running Shell Commands<a class="headerlink" href="#running-shell-commands" title="Permanent link">&para;</a></h2>
<p>The <em>vagrant</em> Command Runner invokes <code>/bin/sh</code> to execute commands, allowing the use of redirection and piping.</p>
<div class="tabbed-set" data-tabs="1:2"><input checked="checked" id="__tabbed_1_1" name="__tabbed_1" type="radio" /><label for="__tabbed_1_1">Command-line</label><div class="tabbed-content">
<div class="highlight"><pre><span></span><code>&gt; build-magic --verbose <span class="se">\</span>
  --runner vagrant <span class="se">\</span>
  --environment Vagrantfile <span class="se">\</span>
  -c execute <span class="s1">&#39;echo &quot;hello world&quot; &gt; hello.txt&#39;</span> <span class="se">\</span>
  -c execute <span class="s1">&#39;cat hello.txt&#39;</span>
</code></pre></div>
</div>
<input id="__tabbed_1_2" name="__tabbed_1" type="radio" /><label for="__tabbed_1_2">Config File</label><div class="tabbed-content">
<div class="highlight"><pre><span></span><code><span class="nt">build-magic</span><span class="p">:</span>
  <span class="p p-Indicator">-</span> <span class="nt">stage</span><span class="p">:</span>
      <span class="nt">runner</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">vagrant</span>
      <span class="nt">environment</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">Vagrantfile</span>
      <span class="nt">commands</span><span class="p">:</span>
        <span class="p p-Indicator">-</span> <span class="nt">execute</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">echo &quot;hello world&quot; &gt; hello.txt</span>
        <span class="p p-Indicator">-</span> <span class="nt">execute</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">cat hello.txt</span>
</code></pre></div>
</div>
</div>
<p>Environment variables can be included in commands by wrapping the command in single quotes:</p>
<div class="tabbed-set" data-tabs="2:2"><input checked="checked" id="__tabbed_2_1" name="__tabbed_2" type="radio" /><label for="__tabbed_2_1">Command-line</label><div class="tabbed-content">
<div class="highlight"><pre><span></span><code>&gt; build-magic --verbose <span class="se">\</span>
--runner vagrant <span class="se">\</span>
--environment Vagrantfile <span class="se">\</span>
<span class="s1">&#39;echo $TERM&#39;</span>
</code></pre></div>
</div>
<input id="__tabbed_2_2" name="__tabbed_2" type="radio" /><label for="__tabbed_2_2">Config File</label><div class="tabbed-content">
<div class="highlight"><pre><span></span><code><span class="nt">build-magic</span><span class="p">:</span>
  <span class="p p-Indicator">-</span> <span class="nt">stage</span><span class="p">:</span>
      <span class="nt">runner</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">vagrant</span>
      <span class="nt">environment</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">Vagrantfile</span>
      <span class="nt">commands</span><span class="p">:</span>
        <span class="p p-Indicator">-</span> <span class="nt">execute</span><span class="p">:</span> <span class="s">&#39;echo</span><span class="nv"> </span><span class="s">$TERM&#39;</span>
</code></pre></div>
</div>
</div>
<h2 id="setting-the-working-directory">Setting the Working Directory<a class="headerlink" href="#setting-the-working-directory" title="Permanent link">&para;</a></h2>
<p>When using the <em>vagrant</em> Command Runner, the Working Directory option <strong>--wd</strong> refers to the Working Directory within the virtual machine.</p>
<p><img alt="diagram" src="https://mermaid.ink/img/eyJjb2RlIjoiZ3JhcGggTFJcbiAgICBzdWJncmFwaCBIb3N0XG4gICAgYShIb3N0IFdvcmtpbmcgRGlyZWN0b3J5KVxuICAgIGVuZFxuICAgIHN1YmdyYXBoIFZpcnR1YWwgTWFjaGluZVxuICAgIGIoQmluZCBEaXJlY3RvcnkpXG4gICAgYyhXb3JraW5nIERpcmVjdG9yeSlcbiAgICBiIC0tPiBjXG4gICAgZW5kXG4gICAgYSAtLT4gYiIsIm1lcm1haWQiOnt9LCJ1cGRhdGVFZGl0b3IiOmZhbHNlfQ" /></p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The host working directory and bind directory are set from the Vagrantfile with <code>config.vm.synced_folder</code>. See the Vagrant Synced Folders <a href="https://www.vagrantup.com/docs/synced-folders">documentation</a> for details.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If setting the host working directory or bind directory, build-magic creates a new Vagrantfile named <em>Vagrantfile_build_magic</em> in the same directory as the user specified Vagrantfile. This new Vagrantfile contains the content of the user specified Vagrantfile, as well as the new config.</p>
</div>
<p>Unlike the <em>docker</em> Command Runner, the Working Directory and Bind Directory for the <em>vagrant</em> Command Runner do not default to the same directory. The Working Directory defaults to <code>/home/vagrant</code> and the Bind Directory defaults to <code>/vagrant</code>. This means if you want the Working Directory to be set to the Bind Directory, the <strong>--wd</strong> option must be used to set the Working Directory to <code>/vagrant</code>.</p>
<div class="tabbed-set" data-tabs="3:2"><input checked="checked" id="__tabbed_3_1" name="__tabbed_3" type="radio" /><label for="__tabbed_3_1">Command-line</label><div class="tabbed-content">
<div class="highlight"><pre><span></span><code>&gt; build-magic -r vagrant -e . --wd /vagrant make
</code></pre></div>
</div>
<input id="__tabbed_3_2" name="__tabbed_3" type="radio" /><label for="__tabbed_3_2">Config File</label><div class="tabbed-content">
<div class="highlight"><pre><span></span><code><span class="nt">build-magic</span><span class="p">:</span>
  <span class="p p-Indicator">-</span> <span class="nt">stage</span><span class="p">:</span>
      <span class="nt">runner</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">vagrant</span>
      <span class="nt">environment</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">.</span>
      <span class="nt">working directory</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">/vagrant</span>
      <span class="nt">commands</span><span class="p">:</span>
        <span class="p p-Indicator">-</span> <span class="nt">execute</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">make</span>
</code></pre></div>
</div>
</div>
<h2 id="copying-files-into-the-virtual-machine">Copying Files Into the Virtual Machine<a class="headerlink" href="#copying-files-into-the-virtual-machine" title="Permanent link">&para;</a></h2>
<p>By using synced folders, all files in Host Working Directory are available from the Bind Directory in the virtual machine. While it's possible to work on files in the Bind Directory, it isn't recommended for I/O intensive operations like compiling code. Some of the synced folder implementations Vagrant uses have significant overhead associated with the mount, so in situations where performance is slow, it's a good idea to instead copy files from the Bind Directory to the Working Directory.</p>
<p>Individual files can be copied into the virtual machine from a directory specified with the <strong>--copy</strong> option. If using the <strong>--copy</strong> option, the files to copy should be specified as arguments.</p>
<div class="tabbed-set" data-tabs="4:2"><input checked="checked" id="__tabbed_4_1" name="__tabbed_4" type="radio" /><label for="__tabbed_4_1">Command-line</label><div class="tabbed-content">
<div class="highlight"><pre><span></span><code>&gt; build-magic <span class="se">\</span>
  --runner vagrant <span class="se">\</span>
  --environment Vagrantfile <span class="se">\</span>
  --copy /home/myproject <span class="se">\</span>
  --command install <span class="s2">&quot;apk add gcc&quot;</span> <span class="se">\</span>
  --command build <span class="s1">&#39;make&#39;</span> <span class="se">\</span>
  main.cpp plugins.cpp audio.cpp
</code></pre></div>
</div>
<input id="__tabbed_4_2" name="__tabbed_4" type="radio" /><label for="__tabbed_4_2">Config File</label><div class="tabbed-content">
<div class="highlight"><pre><span></span><code><span class="nt">build-magic</span><span class="p">:</span>
  <span class="p p-Indicator">-</span> <span class="nt">stage</span><span class="p">:</span>
      <span class="nt">runner</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">vagrant</span>
      <span class="nt">environment</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">Vagrantfile</span>
      <span class="nt">copy from directory</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">/home/myproject</span>
      <span class="nt">artifacts</span><span class="p">:</span>
        <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">main.cpp</span>
        <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">plugins.cpp</span>
        <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">audio.cpp</span>
      <span class="nt">commands</span><span class="p">:</span>
        <span class="p p-Indicator">-</span> <span class="nt">install</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">apk add gcc</span>
        <span class="p p-Indicator">-</span> <span class="nt">build</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">make</span>
</code></pre></div>
</div>
</div>
<h2 id="debugging-the-virtual-machine">Debugging the Virtual Machine<a class="headerlink" href="#debugging-the-virtual-machine" title="Permanent link">&para;</a></h2>
<p>If a command fails in the container for an unknown reason, the <em>persist</em> Action can be used for troubleshooting. The <em>persist</em> Action will keep the container running in the background after build-magic has exited.</p>
<div class="tabbed-set" data-tabs="5:2"><input checked="checked" id="__tabbed_5_1" name="__tabbed_5" type="radio" /><label for="__tabbed_5_1">Command-line</label><div class="tabbed-content">
<div class="highlight"><pre><span></span><code>&gt; build-magic --runner vagrant <span class="se">\</span>
  --environment Vagrantfile <span class="se">\</span>
  --action persist <span class="se">\</span>
  --command execute <span class="s2">&quot;cp&quot;</span>
</code></pre></div>
</div>
<input id="__tabbed_5_2" name="__tabbed_5" type="radio" /><label for="__tabbed_5_2">Config File</label><div class="tabbed-content">
<div class="highlight"><pre><span></span><code><span class="nt">build-magic</span><span class="p">:</span>
  <span class="p p-Indicator">-</span> <span class="nt">stage</span><span class="p">:</span>
      <span class="nt">runner</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">vagrant</span>
      <span class="nt">environment</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">Vagrantfile</span>
      <span class="nt">action</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">persist</span>
      <span class="nt">commands</span><span class="p">:</span>
        <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">execute cp</span>
</code></pre></div>
</div>
</div>
<p>The command <code>cp</code> will fail because it doesn't have any arguments. The virtual machine will continue to run and can be accessed with:</p>
<div class="highlight"><pre><span></span><code>&gt; vagrant ssh
</code></pre></div>
<p>When finished, exit the virtual machine with <code>exit</code>. The virtual machine can then be stopped and destroyed with:</p>
<div class="highlight"><pre><span></span><code>&gt; vagrant destroy
</code></pre></div>
                
              
              
                


              
            </article>
          </div>
        </div>
        
      </main>
      
        
<footer class="md-footer">
  
    <nav class="md-footer__inner md-grid" aria-label="Footer">
      
        <a href="../docker_usage/" class="md-footer__link md-footer__link--prev" rel="prev">
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
          </div>
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Previous
              </span>
              Using the Docker Runner
            </div>
          </div>
        </a>
      
      
        <a href="../remote_usage/" class="md-footer__link md-footer__link--next" rel="next">
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Next
              </span>
              Using the Remote Runner
            </div>
          </div>
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"/></svg>
          </div>
        </a>
      
    </nav>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
        Made with
        <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
          Material for MkDocs
        </a>
        
      </div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    <script id="__config" type="application/json">{"base": "../../..", "features": [], "translations": {"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.term.missing": "Missing"}, "search": "../../../assets/javascripts/workers/search.fe42c31b.min.js", "version": null}</script>
    
    
      <script src="../../../assets/javascripts/bundle.4ea5477f.min.js"></script>
      
    
  </body>
</html>