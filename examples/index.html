
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
      <link rel="icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.2.3, mkdocs-material-7.1.2">
    
    
      
        <title>Examples - build-magic</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.6f955dcd.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.ef6f36e2.min.css">
        
          
          
          <meta name="theme-color" content="#009485">
        
      
    
    
    
      
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback">
        <style>:root{--md-text-font-family:"Roboto";--md-code-font-family:"Roboto Mono"}</style>
      
    
    
    
    
      
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="" data-md-color-primary="teal" data-md-color-accent="light-blue">
  
    
    <script>function __prefix(e){return new URL("..",location).pathname+"."+e}function __get(e,t=localStorage){return JSON.parse(t.getItem(__prefix(e)))}</script>
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#build-magic-examples" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="build-magic" class="md-header__button md-logo" aria-label="build-magic" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            build-magic
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Examples
            
          </span>
        </div>
      </div>
    </div>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
      </label>
      
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" data-md-state="active" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </label>
      <button type="reset" class="md-search__icon md-icon" aria-label="Clear" tabindex="-1">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="build-magic" class="md-nav__button md-logo" aria-label="build-magic" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    build-magic
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        Home
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../CHANGELOG/" class="md-nav__link">
        What's New
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../getting_started/" class="md-nav__link">
        Getting Started
      </a>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4" type="checkbox" id="__nav_4" >
      
      <label class="md-nav__link" for="__nav_4">
        User Guide
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="User Guide" data-md-level="1">
        <label class="md-nav__title" for="__nav_4">
          <span class="md-nav__icon md-icon"></span>
          User Guide
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../user_guide/core_concepts/" class="md-nav__link">
        Core Concepts
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../user_guide/basic_usage/" class="md-nav__link">
        Using Build-magic
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../user_guide/cli_usage/" class="md-nav__link">
        Using the CLI
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../user_guide/config_usage/" class="md-nav__link">
        Defining Config Files
      </a>
    </li>
  

          
            
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_5" type="checkbox" id="__nav_4_5" >
      
      <label class="md-nav__link" for="__nav_4_5">
        Using Command Runners
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Using Command Runners" data-md-level="2">
        <label class="md-nav__title" for="__nav_4_5">
          <span class="md-nav__icon md-icon"></span>
          Using Command Runners
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../user_guide/runners/local_usage/" class="md-nav__link">
        Using the Local Runner
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../user_guide/runners/docker_usage/" class="md-nav__link">
        Using the Docker Runner
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../user_guide/runners/vagrant_usage/" class="md-nav__link">
        Using the Vagrant Runner
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../user_guide/runners/remote_usage/" class="md-nav__link">
        Using the Remote Runner
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          Examples
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        Examples
      </a>
      
        
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#distributing-a-python-package" class="md-nav__link">
    Distributing A Python Package
  </a>
  
    <nav class="md-nav" aria-label="Distributing A Python Package">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#code" class="md-nav__link">
    Code
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#converting-an-openapi-schema-to-slate-with-widdershins" class="md-nav__link">
    Converting An OpenAPI Schema To Slate With Widdershins
  </a>
  
    <nav class="md-nav" aria-label="Converting An OpenAPI Schema To Slate With Widdershins">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#explanation" class="md-nav__link">
    Explanation
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#code_1" class="md-nav__link">
    Code
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#building-and-testing-a-docker-image-in-a-virtual-machine" class="md-nav__link">
    Building And Testing A Docker Image In a Virtual Machine
  </a>
  
    <nav class="md-nav" aria-label="Building And Testing A Docker Image In a Virtual Machine">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#explanation_1" class="md-nav__link">
    Explanation
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#code_2" class="md-nav__link">
    Code
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#automating-a-machine-learning-pipeline" class="md-nav__link">
    Automating A Machine Learning Pipeline
  </a>
  
    <nav class="md-nav" aria-label="Automating A Machine Learning Pipeline">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#explanation_2" class="md-nav__link">
    Explanation
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#code_3" class="md-nav__link">
    Code
  </a>
  
    <nav class="md-nav" aria-label="Code">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#the-server" class="md-nav__link">
    The Server
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#etl" class="md-nav__link">
    ETL
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#model-training" class="md-nav__link">
    Model Training
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../comparison/" class="md-nav__link">
        Comparison with Similar Tools
      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#distributing-a-python-package" class="md-nav__link">
    Distributing A Python Package
  </a>
  
    <nav class="md-nav" aria-label="Distributing A Python Package">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#code" class="md-nav__link">
    Code
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#converting-an-openapi-schema-to-slate-with-widdershins" class="md-nav__link">
    Converting An OpenAPI Schema To Slate With Widdershins
  </a>
  
    <nav class="md-nav" aria-label="Converting An OpenAPI Schema To Slate With Widdershins">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#explanation" class="md-nav__link">
    Explanation
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#code_1" class="md-nav__link">
    Code
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#building-and-testing-a-docker-image-in-a-virtual-machine" class="md-nav__link">
    Building And Testing A Docker Image In a Virtual Machine
  </a>
  
    <nav class="md-nav" aria-label="Building And Testing A Docker Image In a Virtual Machine">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#explanation_1" class="md-nav__link">
    Explanation
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#code_2" class="md-nav__link">
    Code
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#automating-a-machine-learning-pipeline" class="md-nav__link">
    Automating A Machine Learning Pipeline
  </a>
  
    <nav class="md-nav" aria-label="Automating A Machine Learning Pipeline">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#explanation_2" class="md-nav__link">
    Explanation
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#code_3" class="md-nav__link">
    Code
  </a>
  
    <nav class="md-nav" aria-label="Code">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#the-server" class="md-nav__link">
    The Server
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#etl" class="md-nav__link">
    ETL
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#model-training" class="md-nav__link">
    Model Training
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content" data-md-component="content">
            <article class="md-content__inner md-typeset">
              
                
                
                <h1 id="build-magic-examples">Build-magic Examples<a class="headerlink" href="#build-magic-examples" title="Permanent link">&para;</a></h1>
<p>Below, you will find a collection of example build-magic use cases. If you want to run any of the examples yourself, clone the <a href="https://github.com/cmmorrow/build-magic-examples">build-magic-examples</a> repository to get started.</p>
<ul>
<li><a href="./#distributing-a-python-package">Distributing A Python Package</a></li>
<li><a href="./#converting-an-openapi-schema-to-slate-with-widdershins">Converting An OpenAPI Schema To Slate With Widdershins</a></li>
<li><a href="./#building-and-testing-a-docker-image-in-a-virtual-machine">Building And Testing A Docker Image In a Virtual Machine</a></li>
<li><a href="./#automating-a-machine-learning-pipeline">Automating A Machine Learning Pipeline</a></li>
</ul>
<h2 id="distributing-a-python-package">Distributing A Python Package<a class="headerlink" href="#distributing-a-python-package" title="Permanent link">&para;</a></h2>
<p>Test, build, and release a Python package to the <a href="https://pypi.org/">python package index</a>.</p>
<p>This Config File assumes you have a Python package with a setup.py file, a pypi.org account, pypi.org credentials available in $PATH, documentation on GitHub pages, and the pytest, flake8, mkdocs, and twine packages installed.</p>
<p>To run the Config File, execute <code>build-magic -C release.yaml</code>.</p>
<h3 id="code">Code<a class="headerlink" href="#code" title="Permanent link">&para;</a></h3>
<div class="tabbed-set" data-tabs="1:1"><input checked="checked" id="__tabbed_1_1" name="__tabbed_1" type="radio" /><label for="__tabbed_1_1">release.yaml</label><div class="tabbed-content"></div>
</div>
<div class="highlight"><pre><span></span><code><span class="nt">build-magic</span><span class="p">:</span>
  <span class="p p-Indicator">-</span> <span class="nt">stage</span><span class="p">:</span>
      <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">Run Tests</span>
      <span class="nt">commands</span><span class="p">:</span>
        <span class="p p-Indicator">-</span> <span class="nt">execute</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">flake8 --count --show-source --statistics</span>
        <span class="p p-Indicator">-</span> <span class="nt">test</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">pytest -c unit_test.toml</span>
  <span class="p p-Indicator">-</span> <span class="nt">stage</span><span class="p">:</span>
      <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">Build Documentation</span>
      <span class="nt">action</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">cleanup</span>
      <span class="nt">commands</span><span class="p">:</span>
        <span class="p p-Indicator">-</span> <span class="nt">build</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">mkdocs build</span>
        <span class="p p-Indicator">-</span> <span class="nt">deploy</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">mkdocs gh-deploy</span>
  <span class="p p-Indicator">-</span> <span class="nt">stage</span><span class="p">:</span>
      <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">Deploy to PyPI</span>
      <span class="nt">action</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">cleanup</span>
      <span class="nt">commands</span><span class="p">:</span>
        <span class="p p-Indicator">-</span> <span class="nt">build</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">python setup.py sdist bdist_wheel --universal</span>
        <span class="p p-Indicator">-</span> <span class="nt">release</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">twine upload dist/*</span>
</code></pre></div>
<h2 id="converting-an-openapi-schema-to-slate-with-widdershins">Converting An OpenAPI Schema To Slate With Widdershins<a class="headerlink" href="#converting-an-openapi-schema-to-slate-with-widdershins" title="Permanent link">&para;</a></h2>
<p>Builds API documentation for an OpenAPI schema.</p>
<p>This example assumes you have Docker installed.</p>
<h3 id="explanation">Explanation<a class="headerlink" href="#explanation" title="Permanent link">&para;</a></h3>
<p>The build process for the documentation is split into five stages:</p>
<ul>
<li>prep</li>
<li>fetch</li>
<li>convert</li>
<li>build</li>
<li>cleanup</li>
</ul>
<p>To ensure the build pipeline runs on any machine, each stage is run in a Docker container. The prep stage builds the images that will be used by the fetch, convert, and build stages.</p>
<p>The fetch stage downloads the petstore OpenAPI schema that will be used by this example and pretty prints it to the file petstore3.json with jq.</p>
<p>The convert step uses the widdershins npm package convert the petstore3.json file to markdown that can be consumed by slate.</p>
<p>The build stage uses the slate Ruby package to generate the documentation. Slate uses middleman to build the docs is picky about filesystem structure, so the working directory needs to be set as the directory with Slate's boilerplate code. The name of the markdown file also needs to be changed to index.html.md. The build docs are then extracted and exposed to the file system on the host machine through the bind directory /app.</p>
<p>Finally, the cleanup step remove the Docker images created for each stage so as to not take up extra disk space and provide clean images each time.</p>
<p>Notice how most of the heavy lifting is shifted to the Dockerfiles associated with each step. This encapsulates the setup and applications needed for each stage in the Dockerfile, and the build_docs.yaml Config File only contains the commands needed for building the docs. This also has the advantage that if wget, jq, widdershins, and slate are installed on the host machine, the Config File can be easily modified to use the local command runner without having to modify the executed commands.</p>
<p>To run the Config File, execute <code>build-magic -C build_docs.yaml</code>.</p>
<h3 id="code_1">Code<a class="headerlink" href="#code_1" title="Permanent link">&para;</a></h3>
<div class="tabbed-set" data-tabs="2:1"><input checked="checked" id="__tabbed_2_1" name="__tabbed_2" type="radio" /><label for="__tabbed_2_1">build_docs.yaml</label><div class="tabbed-content"></div>
</div>
<div class="highlight"><pre><span></span><code><span class="nt">build-magic</span><span class="p">:</span>
  <span class="p p-Indicator">-</span> <span class="nt">stage</span><span class="p">:</span>
      <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">prep</span>
      <span class="nt">commands</span><span class="p">:</span>
        <span class="p p-Indicator">-</span> <span class="nt">build</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">docker build -t fetch ./fetch</span>
        <span class="p p-Indicator">-</span> <span class="nt">build</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">docker build -t widdershins ./widdershins</span>
        <span class="p p-Indicator">-</span> <span class="nt">build</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">docker build -t slate ./slate</span>
  <span class="p p-Indicator">-</span> <span class="nt">stage</span><span class="p">:</span>
      <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">fetch</span>
      <span class="nt">runner</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">docker</span>
      <span class="nt">environment</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">fetch</span>
      <span class="nt">commands</span><span class="p">:</span> 
        <span class="p p-Indicator">-</span> <span class="nt">execute</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">wget https://petstore3.swagger.io/api/v3/openapi.json</span>
        <span class="p p-Indicator">-</span> <span class="nt">execute</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">cat openapi.json | jq &gt; petstore3.json</span>
        <span class="p p-Indicator">-</span> <span class="nt">execute</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">rm openapi.json</span>
  <span class="p p-Indicator">-</span> <span class="nt">stage</span><span class="p">:</span>
      <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">convert</span>
      <span class="nt">runner</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">docker</span>
      <span class="nt">environment</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">widdershins</span>
      <span class="nt">commands</span><span class="p">:</span>
        <span class="p p-Indicator">-</span> <span class="nt">execute</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">widdershins --summary petstore3.json petstore3.md</span>
  <span class="p p-Indicator">-</span> <span class="nt">stage</span><span class="p">:</span>
      <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">build</span>
      <span class="nt">runner</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">docker</span>
      <span class="nt">environment</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">slate</span>
      <span class="nt">working directory</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">/srv/slate/source</span>
      <span class="nt">parameters</span><span class="p">:</span>
        <span class="nt">bind</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">/app</span>
      <span class="nt">commands</span><span class="p">:</span>
        <span class="p p-Indicator">-</span> <span class="nt">execute</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">cp /app/petstore3.md /srv/slate/source/index.html.md</span>
        <span class="p p-Indicator">-</span> <span class="nt">build</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">bundle exec middleman build</span>
        <span class="p p-Indicator">-</span> <span class="nt">execute</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">cp -r /srv/slate/build /app</span>
  <span class="p p-Indicator">-</span> <span class="nt">stage</span><span class="p">:</span>
      <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">cleanup</span>
      <span class="nt">commands</span><span class="p">:</span>
        <span class="p p-Indicator">-</span> <span class="nt">execute</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">docker rmi fetch</span>
        <span class="p p-Indicator">-</span> <span class="nt">execute</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">docker rmi widdershins</span>
        <span class="p p-Indicator">-</span> <span class="nt">execute</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">docker rmi slate</span>
</code></pre></div>
<div class="tabbed-set" data-tabs="3:3"><input checked="checked" id="__tabbed_3_1" name="__tabbed_3" type="radio" /><label for="__tabbed_3_1">fetch/Dockerfile</label><div class="tabbed-content">
<div class="highlight"><pre><span></span><code><span class="k">FROM</span> <span class="s">alpine:latest</span>
<span class="k">RUN</span> apk add wget jq
<span class="k">CMD</span> <span class="p">[</span> <span class="s2">&quot;/bin/sh&quot;</span> <span class="p">]</span>
</code></pre></div>
</div>
<input id="__tabbed_3_2" name="__tabbed_3" type="radio" /><label for="__tabbed_3_2">widdershins/Dockerfile</label><div class="tabbed-content">
<div class="highlight"><pre><span></span><code><span class="k">FROM</span> <span class="s">node:alpine</span>
<span class="k">RUN</span> npm install -g widdershins
<span class="k">CMD</span> <span class="p">[</span> <span class="s2">&quot;/bin/sh&quot;</span> <span class="p">]</span>
</code></pre></div>
</div>
<input id="__tabbed_3_3" name="__tabbed_3" type="radio" /><label for="__tabbed_3_3">slate/Dockerfile</label><div class="tabbed-content">
<div class="highlight"><pre><span></span><code><span class="k">FROM</span> <span class="s">ruby:slim</span>
<span class="k">RUN</span> apt update <span class="o">&amp;&amp;</span> <span class="se">\</span>
apt install -y build-essential nodejs tar wget
<span class="k">RUN</span> wget https://github.com/slatedocs/slate/archive/refs/tags/v2.12.0.tar.gz <span class="o">&amp;&amp;</span> <span class="se">\</span>
tar -xzf v2.12.0.tar.gz <span class="o">&amp;&amp;</span> <span class="se">\</span>
mv slate-2.12.0 /srv/slate
<span class="k">RUN</span> gem install bundler <span class="o">&amp;&amp;</span> <span class="se">\</span>
<span class="nv">BUNDLE_GEMFILE</span><span class="o">=</span><span class="s2">&quot;/srv/slate/Gemfile&quot;</span> bundle install
<span class="k">CMD</span> <span class="p">[</span> <span class="s2">&quot;/bin/sh&quot;</span> <span class="p">]</span>
</code></pre></div>
</div>
</div>
<h2 id="building-and-testing-a-docker-image-in-a-virtual-machine">Building And Testing A Docker Image In a Virtual Machine<a class="headerlink" href="#building-and-testing-a-docker-image-in-a-virtual-machine" title="Permanent link">&para;</a></h2>
<p>Builds a Docker image in a virtual machine.</p>
<p>This example assumes you have Vagrant installed.</p>
<h3 id="explanation_1">Explanation<a class="headerlink" href="#explanation_1" title="Permanent link">&para;</a></h3>
<p>This example uses the Vagrant runner and the Alpine Linux Vagrant Box, as defined in the Vagrantfile. The docker and curl packages are installed and Docker is started. Next, the Docker image is built from the Dockerfile.</p>
<p>The Dockerfile is available in the virtual machine by setting the working directory and bind directory to <strong>/app</strong>. By doing this, the Vagrantfile is updated on the fly to include <code>config.vm.synced_folder ".", "/app"</code> which syncs the current directory on the host machine with the /app directory in the virtual machine.</p>
<p>Next, the Docker image is run and curl is used to call the web service running the Docker container. If the response from the container is what's expected by the test, it passes and we know the image for our web service was built correctly. The image is then tagged and pushed to an image repository on AWS.</p>
<p>To run the Config File, execute <code>build-magic -C build_image.yaml -v app myapp -v port 3000</code>.</p>
<h3 id="code_2">Code<a class="headerlink" href="#code_2" title="Permanent link">&para;</a></h3>
<div class="tabbed-set" data-tabs="4:1"><input checked="checked" id="__tabbed_4_1" name="__tabbed_4" type="radio" /><label for="__tabbed_4_1">build_image.yaml</label><div class="tabbed-content"></div>
</div>
<div class="highlight"><pre><span></span><code><span class="nt">build-magic</span><span class="p">:</span>
  <span class="p p-Indicator">-</span> <span class="nt">stage</span><span class="p">:</span>
      <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">Docker build example</span>
      <span class="nt">runner</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">vagrant</span>
      <span class="nt">environment</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">Vagrantfile</span>
      <span class="nt">working directory</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">/app</span>
      <span class="nt">parameters</span><span class="p">:</span>
        <span class="nt">bind</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">/app</span>
      <span class="nt">commands</span><span class="p">:</span>
        <span class="p p-Indicator">-</span> <span class="nt">install</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">sudo apk update &amp;&amp; sudo apk add docker curl</span>
          <span class="nt">label</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">Install docker and curl</span>
        <span class="p p-Indicator">-</span> <span class="nt">execute</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">sudo service docker start</span>
          <span class="nt">label</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">Start dockerd</span>
        <span class="p p-Indicator">-</span> <span class="nt">build</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">sudo docker build -t {{ app }} .</span>
          <span class="nt">label</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">Build docker image</span>
        <span class="p p-Indicator">-</span> <span class="nt">execute</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">sudo docker run -d --rm --name {{ app }} -p {{ port }}:3000 {{ app }}</span>
          <span class="nt">label</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">Run the docker container</span>
        <span class="p p-Indicator">-</span> <span class="nt">execute</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">sleep 5</span>
          <span class="nt">label</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">Wait 5 seconds for the container to start</span>
        <span class="p p-Indicator">-</span> <span class="nt">test</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">export RESULT=`curl -s http://localhost:{{ port }}` &amp;&amp; test &quot;$RESULT&quot; = &#39;{&quot;message&quot;:&quot;Hello World&quot;}&#39;</span>
          <span class="nt">label</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">Test the endpoint</span>
        <span class="p p-Indicator">-</span> <span class="nt">execute</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">sudo docker stop {{ app }}</span>
          <span class="nt">label</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">Stop the docker container</span>
        <span class="p p-Indicator">-</span> <span class="nt">execute</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">sudo docker tag {{ app }}:latest {{ account_id }}.dkr.ecr.us-east-1.amazonaws.com/{{ app }}:latest</span>
        <span class="p p-Indicator">-</span> <span class="nt">release</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">sudo docker push {{ account_id }}.dkr.ecr.us-east-1.amazonaws.com/{{ app }}:latest</span>
</code></pre></div>
<div class="tabbed-set" data-tabs="5:1"><input checked="checked" id="__tabbed_5_1" name="__tabbed_5" type="radio" /><label for="__tabbed_5_1">Vagrantfile</label><div class="tabbed-content"></div>
</div>
<div class="highlight"><pre><span></span><code><span class="no">Vagrant</span><span class="o">.</span><span class="n">configure</span><span class="p">(</span><span class="s2">&quot;2&quot;</span><span class="p">)</span> <span class="k">do</span> <span class="o">|</span><span class="n">config</span><span class="o">|</span>
    <span class="n">config</span><span class="o">.</span><span class="n">vm</span><span class="o">.</span><span class="n">box</span> <span class="o">=</span> <span class="s2">&quot;generic/alpine312&quot;</span>
<span class="k">end</span>
</code></pre></div>
<div class="tabbed-set" data-tabs="6:1"><input checked="checked" id="__tabbed_6_1" name="__tabbed_6" type="radio" /><label for="__tabbed_6_1">Dockerfile</label><div class="tabbed-content"></div>
</div>
<div class="highlight"><pre><span></span><code><span class="k">FROM</span> <span class="s">alpine:latest</span>
<span class="k">WORKDIR</span><span class="s"> /app</span>
<span class="k">COPY</span> main.py requirements.txt /app/
<span class="k">RUN</span> apk add python3 py3-pip
<span class="k">RUN</span> pip3 install -r requirements.txt
<span class="k">EXPOSE</span><span class="s"> 3000</span>
<span class="k">ENTRYPOINT</span> <span class="p">[</span><span class="s2">&quot;uvicorn&quot;</span><span class="p">,</span> <span class="s2">&quot;main:app&quot;</span><span class="p">,</span> <span class="s2">&quot;--host&quot;</span><span class="p">,</span> <span class="s2">&quot;0.0.0.0&quot;</span><span class="p">,</span> <span class="s2">&quot;--port&quot;</span><span class="p">,</span> <span class="s2">&quot;3000&quot;</span><span class="p">]</span>
</code></pre></div>
<div class="tabbed-set" data-tabs="7:1"><input checked="checked" id="__tabbed_7_1" name="__tabbed_7" type="radio" /><label for="__tabbed_7_1">main.py</label><div class="tabbed-content"></div>
</div>
<div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">fastapi</span> <span class="kn">import</span> <span class="n">FastAPI</span>


<span class="n">app</span> <span class="o">=</span> <span class="n">FastAPI</span><span class="p">()</span>


<span class="nd">@app</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;/&quot;</span><span class="p">)</span>
<span class="k">async</span> <span class="k">def</span> <span class="nf">root</span><span class="p">():</span>
    <span class="k">return</span> <span class="p">{</span><span class="s2">&quot;message&quot;</span><span class="p">:</span> <span class="s2">&quot;Hello World&quot;</span><span class="p">}</span>
</code></pre></div>
<h2 id="automating-a-machine-learning-pipeline">Automating A Machine Learning Pipeline<a class="headerlink" href="#automating-a-machine-learning-pipeline" title="Permanent link">&para;</a></h2>
<p>A data pipeline that loads data, trains a model, and deploys the model to a web service.</p>
<p>This example assumes you have Docker installed. A virtual environment should also be used to install python 3.6+ and the dependencies in requirements.txt.</p>
<p>Before running the pipeline, the webserver that uses the model should be started by running the start_server.sh script.</p>
<h3 id="explanation_2">Explanation<a class="headerlink" href="#explanation_2" title="Permanent link">&para;</a></h3>
<p>The pipeline is split into three stages:</p>
<ul>
<li>etl</li>
<li>train</li>
<li>deploy</li>
</ul>
<p>The etl stage starts by downloading the winequality-red dataset as a csv file. It then runs <strong>etl.py</strong> which abstracts away the details of converting the csv file to a feather file.</p>
<p>The train stage abstracts away details about training a model based on the data in the feather file. This allows for flexibility in defining a model by providing a single interface (<strong>train.py</strong>) that can accept input arguments from the command-line for building the model. The output of <strong>train.py</strong> is written to a text file and the model, as a pickle file, is gpg signed and encrypted for improved security. This step is likely unnecessary when running the webserver on the same machine where the model is generated, but is recommend when uploading the model to a different machine.</p>
<p>The deploy stage will remove the model currently being used by the webserver, and gpg decrypt and verify the new model. The webserver is then restarted and will pick up and use the new model.</p>
<p>Before running the Config File, the web server should be started with <code>docker run -d -p 3000:3000 -v $PWD/data/deploy:/app/data/deploy:ro --name model_server model_server</code>.</p>
<p>To run the Config File, execute <code>build-magic -C pipeline.yaml -v filename winequality-red_`date "+%Y%m%d%H%M%S"` -v user xxxxx -v server model_server</code>.</p>
<h3 id="code_3">Code<a class="headerlink" href="#code_3" title="Permanent link">&para;</a></h3>
<div class="tabbed-set" data-tabs="8:1"><input checked="checked" id="__tabbed_8_1" name="__tabbed_8" type="radio" /><label for="__tabbed_8_1">pipeline.yaml</label><div class="tabbed-content"></div>
</div>
<div class="highlight"><pre><span></span><code><span class="nt">build-magic</span><span class="p">:</span>
  <span class="p p-Indicator">-</span> <span class="nt">stage</span><span class="p">:</span>
      <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">etl</span>
      <span class="nt">commands</span><span class="p">:</span>
        <span class="p p-Indicator">-</span> <span class="nt">execute</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">curl &quot;http://archive.ics.uci.edu/ml/machine-learning-databases/wine-quality/winequality-red.csv&quot; --output {{ filename }}.csv</span>
          <span class="nt">label</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">Download the dataset</span>
        <span class="p p-Indicator">-</span> <span class="nt">execute</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">python3 etl.py {{ filename }}.csv</span>
          <span class="nt">label</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">Convert the dataset to Arrow</span>
        <span class="p p-Indicator">-</span> <span class="nt">execute</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">mv {{ filename }}.feather data/input</span>
        <span class="p p-Indicator">-</span> <span class="nt">execute</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">rm {{ filename }}.csv</span>
  <span class="p p-Indicator">-</span> <span class="nt">stage</span><span class="p">:</span>
      <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">train</span>
      <span class="nt">commands</span><span class="p">:</span>
        <span class="p p-Indicator">-</span> <span class="nt">execute</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">python3 train.py data/input/{{ filename }}.feather 0.1 0.1 &gt; data/stats/{{ filename }}.stats</span>
          <span class="nt">label</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">Train the model</span>
        <span class="p p-Indicator">-</span> <span class="nt">execute</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">mv {{ filename }}.pickle data/models/{{ filename }}.pickle</span>
        <span class="p p-Indicator">-</span> <span class="nt">execute</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">gpg --output data/models/{{ filename }}.sig -se -r {{ user }} data/models/{{ filename }}.pickle</span>
          <span class="nt">label</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">Sign and encrypt the model</span>
  <span class="p p-Indicator">-</span> <span class="nt">stage</span><span class="p">:</span>
      <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">deploy</span>
      <span class="nt">commands</span><span class="p">:</span>
        <span class="p p-Indicator">-</span> <span class="nt">execute</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">rm -f data/deploy/*</span>
        <span class="p p-Indicator">-</span> <span class="nt">execute</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">cp data/models/{{ filename }}.sig data/deploy</span>
        <span class="p p-Indicator">-</span> <span class="nt">execute</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">gpg --output data/deploy/{{ filename }}.pickle -d data/deploy/{{ filename }}.sig</span>
          <span class="nt">label</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">Verify and decrypt the model</span>
        <span class="p p-Indicator">-</span> <span class="nt">execute</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">rm data/deploy/{{ filename }}.sig</span>
        <span class="p p-Indicator">-</span> <span class="nt">execute</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">docker restart {{ server }}</span>
          <span class="nt">label</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">Restart the web server</span>
</code></pre></div>
<h4 id="the-server">The Server<a class="headerlink" href="#the-server" title="Permanent link">&para;</a></h4>
<p>The webserver has a single endpoint, <strong>/predict</strong>, which accepts a JSON payload. Each key in the JSON payload corresponds to a field in the winequality-red dataset.</p>
<div class="tabbed-set" data-tabs="9:1"><input checked="checked" id="__tabbed_9_1" name="__tabbed_9" type="radio" /><label for="__tabbed_9_1">server.py</label><div class="tabbed-content"></div>
</div>
<div class="highlight"><pre><span></span><code><span class="kn">import</span> <span class="nn">os</span>
<span class="kn">from</span> <span class="nn">pathlib</span> <span class="kn">import</span> <span class="n">Path</span>
<span class="kn">import</span> <span class="nn">pickle</span>

<span class="kn">from</span> <span class="nn">fastapi</span> <span class="kn">import</span> <span class="n">FastAPI</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">from</span> <span class="nn">pydantic</span> <span class="kn">import</span> <span class="n">BaseModel</span>


<span class="n">MODEL_PATH</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;MODEL_PATH&#39;</span><span class="p">,</span> <span class="s1">&#39;.&#39;</span><span class="p">)</span>

<span class="n">app</span> <span class="o">=</span> <span class="n">FastAPI</span><span class="p">()</span>

<span class="n">loaded</span> <span class="o">=</span> <span class="kc">False</span>
<span class="n">_model</span> <span class="o">=</span> <span class="kc">None</span>

<span class="k">class</span> <span class="nc">Vector</span><span class="p">(</span><span class="n">BaseModel</span><span class="p">):</span>
    <span class="n">fixed_acidity</span><span class="p">:</span> <span class="nb">float</span>
    <span class="n">volatile_acidity</span><span class="p">:</span> <span class="nb">float</span>
    <span class="n">citric_acid</span><span class="p">:</span> <span class="nb">float</span>
    <span class="n">residual_sugar</span><span class="p">:</span> <span class="nb">float</span>
    <span class="n">chlorides</span><span class="p">:</span> <span class="nb">float</span>
    <span class="n">free_sulfur_dioxide</span><span class="p">:</span> <span class="nb">float</span>
    <span class="n">total_sulfur_dioxide</span><span class="p">:</span> <span class="nb">float</span>
    <span class="n">density</span><span class="p">:</span> <span class="nb">float</span>
    <span class="n">ph</span><span class="p">:</span> <span class="nb">float</span>
    <span class="n">sulphates</span><span class="p">:</span> <span class="nb">float</span>
    <span class="n">alcohol</span><span class="p">:</span> <span class="nb">float</span>

    <span class="k">def</span> <span class="nf">convert</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">dict</span><span class="p">()</span><span class="o">.</span><span class="n">values</span><span class="p">(),</span>
            <span class="n">index</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">Index</span><span class="p">(</span>
                <span class="p">[</span>
                    <span class="s1">&#39;fixed acidity&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;volatile acidity&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;citric acid&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;residual sugar&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;chlorides&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;free sulfur dioxide&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;total sulfur dioxide&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;density&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;pH&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;sulphates&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;alcohol&#39;</span><span class="p">,</span>
                <span class="p">]</span>
            <span class="p">)</span>
        <span class="p">)</span>

<span class="k">def</span> <span class="nf">model</span><span class="p">():</span>
    <span class="k">global</span> <span class="n">loaded</span>
    <span class="k">global</span> <span class="n">_model</span>
    <span class="k">if</span> <span class="n">loaded</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">_model</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">models</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">([</span><span class="n">m</span> <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="n">Path</span><span class="p">(</span><span class="n">MODEL_PATH</span><span class="p">)</span><span class="o">.</span><span class="n">iterdir</span><span class="p">()],</span> <span class="n">reverse</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">models</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="s1">&#39;rb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">file</span><span class="p">:</span>
            <span class="n">file</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
            <span class="n">model</span> <span class="o">=</span> <span class="n">pickle</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">file</span><span class="p">)</span>
        <span class="n">loaded</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="n">_model</span> <span class="o">=</span> <span class="n">model</span>
        <span class="k">return</span> <span class="n">model</span>

<span class="nd">@app</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="s2">&quot;/predict&quot;</span><span class="p">)</span>
<span class="k">async</span> <span class="k">def</span> <span class="nf">predict</span><span class="p">(</span><span class="n">data</span><span class="p">:</span> <span class="n">Vector</span><span class="p">):</span>
    <span class="n">vector</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">convert</span><span class="p">()</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span>
    <span class="n">result</span> <span class="o">=</span> <span class="n">model</span><span class="p">()</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">vector</span><span class="p">)</span>
    <span class="k">return</span> <span class="p">{</span><span class="s1">&#39;prediction&#39;</span><span class="p">:</span> <span class="nb">round</span><span class="p">(</span><span class="n">result</span><span class="p">[</span><span class="mi">0</span><span class="p">])}</span>
</code></pre></div>
<p>Calling the <strong>/predict</strong> endpoint with the following JSON payload will return the predicted winequality.</p>
<div class="tabbed-set" data-tabs="10:1"><input checked="checked" id="__tabbed_10_1" name="__tabbed_10" type="radio" /><label for="__tabbed_10_1">sample.json</label><div class="tabbed-content"></div>
</div>
<div class="highlight"><pre><span></span><code><span class="p">{</span>
    <span class="nt">&quot;fixed_acidity&quot;</span><span class="p">:</span> <span class="s2">&quot;10.8&quot;</span><span class="p">,</span>
    <span class="nt">&quot;volatile_acidity&quot;</span><span class="p">:</span> <span class="s2">&quot;0.28&quot;</span><span class="p">,</span>
    <span class="nt">&quot;citric_acid&quot;</span><span class="p">:</span> <span class="s2">&quot;0.56&quot;</span><span class="p">,</span>
    <span class="nt">&quot;residual_sugar&quot;</span><span class="p">:</span> <span class="s2">&quot;2.0&quot;</span><span class="p">,</span>
    <span class="nt">&quot;chlorides&quot;</span><span class="p">:</span> <span class="s2">&quot;0.075&quot;</span><span class="p">,</span>
    <span class="nt">&quot;free_sulfur_dioxide&quot;</span><span class="p">:</span> <span class="s2">&quot;17.8&quot;</span><span class="p">,</span>
    <span class="nt">&quot;total_sulfur_dioxide&quot;</span><span class="p">:</span> <span class="s2">&quot;60.3&quot;</span><span class="p">,</span>
    <span class="nt">&quot;density&quot;</span><span class="p">:</span> <span class="s2">&quot;0.9980&quot;</span><span class="p">,</span>
    <span class="nt">&quot;ph&quot;</span><span class="p">:</span> <span class="s2">&quot;3.16&quot;</span><span class="p">,</span>
    <span class="nt">&quot;sulphates&quot;</span><span class="p">:</span> <span class="s2">&quot;0.58&quot;</span><span class="p">,</span>
    <span class="nt">&quot;alcohol&quot;</span><span class="p">:</span> <span class="s2">&quot;10&quot;</span>
<span class="p">}</span>
</code></pre></div>
<p>The webserver is built as a Docker image with the following Dockerfile:</p>
<div class="highlight"><pre><span></span><code><span class="k">FROM</span> <span class="s">ubuntu:latest</span>
<span class="k">WORKDIR</span><span class="s"> /app</span>
<span class="k">COPY</span> server.py requirements.txt /app/
<span class="k">RUN</span> apt update <span class="o">&amp;&amp;</span> apt install python3 python3-pip -y
<span class="k">RUN</span> pip3 install -r requirements.txt
<span class="k">ENV</span> <span class="nv">MODEL_PATH</span><span class="o">=</span>/app/data/deploy
<span class="k">EXPOSE</span><span class="s"> 3000</span>
<span class="k">ENTRYPOINT</span> <span class="p">[</span><span class="s2">&quot;uvicorn&quot;</span><span class="p">,</span> <span class="s2">&quot;server:app&quot;</span><span class="p">,</span> <span class="s2">&quot;--host&quot;</span><span class="p">,</span> <span class="s2">&quot;0.0.0.0&quot;</span><span class="p">,</span> <span class="s2">&quot;--port&quot;</span><span class="p">,</span> <span class="s2">&quot;3000&quot;</span><span class="p">]</span>
</code></pre></div>
<p>The web server should be started with <code>docker run -d -p 3000:3000 -v $PWD/data/deploy:/app/data/deploy:ro --name model_server model_server</code>.</p>
<h4 id="etl">ETL<a class="headerlink" href="#etl" title="Permanent link">&para;</a></h4>
<p>The ETL script simply converts the dataset to a feather file with pyArrow.</p>
<div class="tabbed-set" data-tabs="11:1"><input checked="checked" id="__tabbed_11_1" name="__tabbed_11" type="radio" /><label for="__tabbed_11_1">etl.py</label><div class="tabbed-content"></div>
</div>
<div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">pathlib</span> <span class="kn">import</span> <span class="n">Path</span>
<span class="kn">import</span> <span class="nn">sys</span>

<span class="kn">from</span> <span class="nn">pyarrow</span> <span class="kn">import</span> <span class="n">csv</span>
<span class="kn">import</span> <span class="nn">pyarrow.feather</span> <span class="k">as</span> <span class="nn">feather</span>


<span class="k">def</span> <span class="nf">load_file</span><span class="p">(</span><span class="n">filename</span><span class="p">:</span> <span class="n">Path</span><span class="p">):</span>
    <span class="n">table</span> <span class="o">=</span> <span class="n">csv</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">filename</span><span class="p">),</span> <span class="n">parse_options</span><span class="o">=</span><span class="n">csv</span><span class="o">.</span><span class="n">ParseOptions</span><span class="p">(</span><span class="n">delimiter</span><span class="o">=</span><span class="s1">&#39;;&#39;</span><span class="p">))</span>
    <span class="n">feather_file</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">filename</span><span class="o">.</span><span class="n">stem</span><span class="si">}</span><span class="s1">.feather&#39;</span>
    <span class="n">feather</span><span class="o">.</span><span class="n">write_feather</span><span class="p">(</span><span class="n">table</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">feather_file</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>


<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;CSV file path is required.&quot;</span><span class="p">)</span>
        <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">fn</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">.</span><span class="n">resolve</span><span class="p">()</span>
    <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Cannot load file.&quot;</span><span class="p">)</span>
        <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">load_file</span><span class="p">(</span><span class="n">fn</span><span class="p">)</span>
</code></pre></div>
<h4 id="model-training">Model Training<a class="headerlink" href="#model-training" title="Permanent link">&para;</a></h4>
<p>The training script reads the feather file, trains the model based on the input parameters, prints the model statistics, and saves the model as a pickle file.</p>
<div class="tabbed-set" data-tabs="12:1"><input checked="checked" id="__tabbed_12_1" name="__tabbed_12" type="radio" /><label for="__tabbed_12_1">train.py</label><div class="tabbed-content"></div>
</div>
<div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">pathlib</span> <span class="kn">import</span> <span class="n">Path</span>
<span class="kn">import</span> <span class="nn">pickle</span>
<span class="kn">from</span> <span class="nn">decimal</span> <span class="kn">import</span> <span class="n">Decimal</span>
<span class="kn">import</span> <span class="nn">sys</span>
<span class="kn">from</span> <span class="nn">unicodedata</span> <span class="kn">import</span> <span class="n">decimal</span>

<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">pyarrow.feather</span> <span class="k">as</span> <span class="nn">feather</span>
<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">mean_squared_error</span><span class="p">,</span> <span class="n">mean_absolute_error</span><span class="p">,</span> <span class="n">r2_score</span>
<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">train_test_split</span>
<span class="kn">from</span> <span class="nn">sklearn.linear_model</span> <span class="kn">import</span> <span class="n">ElasticNet</span>


<span class="k">def</span> <span class="nf">load</span><span class="p">(</span><span class="n">filename</span><span class="p">:</span> <span class="n">Path</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
    <span class="k">return</span> <span class="n">feather</span><span class="o">.</span><span class="n">read_feather</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">filename</span><span class="p">))</span>


<span class="k">def</span> <span class="nf">save_model</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">filename</span><span class="p">):</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">Path</span><span class="p">(</span><span class="n">filename</span><span class="p">),</span> <span class="s1">&#39;wb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">file</span><span class="p">:</span>
        <span class="n">pickle</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">file</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">eval_metrics</span><span class="p">(</span><span class="n">actual</span><span class="p">,</span> <span class="n">pred</span><span class="p">):</span>
    <span class="n">rmse</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">mean_squared_error</span><span class="p">(</span><span class="n">actual</span><span class="p">,</span> <span class="n">pred</span><span class="p">))</span>
    <span class="n">mae</span> <span class="o">=</span> <span class="n">mean_absolute_error</span><span class="p">(</span><span class="n">actual</span><span class="p">,</span> <span class="n">pred</span><span class="p">)</span>
    <span class="n">r2</span> <span class="o">=</span> <span class="n">r2_score</span><span class="p">(</span><span class="n">actual</span><span class="p">,</span> <span class="n">pred</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">rmse</span><span class="p">,</span> <span class="n">mae</span><span class="p">,</span> <span class="n">r2</span>


<span class="k">def</span> <span class="nf">train_model</span><span class="p">(</span><span class="n">df</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="n">alpha</span><span class="p">:</span> <span class="n">Decimal</span><span class="p">,</span> <span class="n">l1_ratio</span><span class="p">:</span> <span class="n">Decimal</span><span class="p">):</span>
    <span class="n">train</span><span class="p">,</span> <span class="n">test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mf">0.25</span><span class="p">,</span> <span class="n">train_size</span><span class="o">=</span><span class="mf">0.75</span><span class="p">)</span>
    <span class="n">train_x</span> <span class="o">=</span> <span class="n">train</span><span class="o">.</span><span class="n">drop</span><span class="p">([</span><span class="s2">&quot;quality&quot;</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">test_x</span> <span class="o">=</span> <span class="n">test</span><span class="o">.</span><span class="n">drop</span><span class="p">([</span><span class="s2">&quot;quality&quot;</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">train_y</span> <span class="o">=</span> <span class="n">train</span><span class="p">[[</span><span class="s2">&quot;quality&quot;</span><span class="p">]]</span>
    <span class="n">test_y</span> <span class="o">=</span> <span class="n">test</span><span class="p">[[</span><span class="s2">&quot;quality&quot;</span><span class="p">]]</span>

    <span class="n">lr</span> <span class="o">=</span> <span class="n">ElasticNet</span><span class="p">(</span><span class="n">alpha</span><span class="o">=</span><span class="nb">float</span><span class="p">(</span><span class="n">alpha</span><span class="p">),</span> <span class="n">l1_ratio</span><span class="o">=</span><span class="nb">float</span><span class="p">(</span><span class="n">l1_ratio</span><span class="p">))</span>
    <span class="n">lr</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">train_x</span><span class="p">,</span> <span class="n">train_y</span><span class="p">)</span>

    <span class="n">predicted_qualities</span> <span class="o">=</span> <span class="n">lr</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">test_x</span><span class="p">)</span>
    <span class="p">(</span><span class="n">rmse</span><span class="p">,</span> <span class="n">mae</span><span class="p">,</span> <span class="n">r2</span><span class="p">)</span> <span class="o">=</span> <span class="n">eval_metrics</span><span class="p">(</span><span class="n">test_y</span><span class="p">,</span> <span class="n">predicted_qualities</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;RMSE: </span><span class="si">{</span><span class="n">rmse</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot; MAE: </span><span class="si">{</span><span class="n">mae</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  R2: </span><span class="si">{</span><span class="n">r2</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">lr</span>


<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">4</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Parameters file path, alpha, and l1_ratio required.&quot;</span><span class="p">)</span>
        <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">fn</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">.</span><span class="n">resolve</span><span class="p">()</span>
    <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Cannot load file.&quot;</span><span class="p">)</span>
        <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">alpha</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
    <span class="n">l1_ratio</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">load</span><span class="p">(</span><span class="n">fn</span><span class="p">)</span>
    <span class="n">model</span> <span class="o">=</span> <span class="n">train_model</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">alpha</span><span class="p">,</span> <span class="n">l1_ratio</span><span class="p">)</span>
    <span class="n">pickle_file</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">fn</span><span class="o">.</span><span class="n">stem</span><span class="si">}</span><span class="s2">.pickle&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">save_model</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">pickle_file</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Could not save </span><span class="si">{</span><span class="n">pickle_file</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div>
                
              
              
                


              
            </article>
          </div>
        </div>
        
      </main>
      
        
<footer class="md-footer">
  
    <nav class="md-footer__inner md-grid" aria-label="Footer">
      
        <a href="../user_guide/runners/remote_usage/" class="md-footer__link md-footer__link--prev" rel="prev">
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
          </div>
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Previous
              </span>
              Using the Remote Runner
            </div>
          </div>
        </a>
      
      
        <a href="../comparison/" class="md-footer__link md-footer__link--next" rel="next">
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Next
              </span>
              Comparison with Similar Tools
            </div>
          </div>
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"/></svg>
          </div>
        </a>
      
    </nav>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
        Made with
        <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
          Material for MkDocs
        </a>
        
      </div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    <script id="__config" type="application/json">{"base": "..", "features": [], "translations": {"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.term.missing": "Missing"}, "search": "../assets/javascripts/workers/search.fe42c31b.min.js", "version": null}</script>
    
    
      <script src="../assets/javascripts/bundle.4ea5477f.min.js"></script>
      
    
  </body>
</html>